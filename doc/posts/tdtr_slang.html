<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        AI for TDTR 探索 - CodiMD
    </title>
    <link rel="icon" type="image/png" href="https://codimd.wuhanstudio.cc/favicon.png">
    <link rel="apple-touch-icon" href="https://codimd.wuhanstudio.cc/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/css/bootstrap.min.css" integrity="sha256-H0KfTigpUV+0/5tn2HXC0CPwhhDhWgSawJdnFd0CGCo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fork-awesome/1.1.3/css/fork-awesome.min.css" integrity="sha256-ZhApazu+kejqTYhMF+1DzNKjIzP7KXu6AzyXcC1gMus=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.night .markdown-body blockquote{color:#bcbcbc}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.night .markdown-body h1,.night .markdown-body h2,.night .markdown-body h3,.night .markdown-body h4,.night .markdown-body h5,.night .markdown-body h6{color:#ddd}.markdown-body h1 .fa-link,.markdown-body h2 .fa-link,.markdown-body h3 .fa-link,.markdown-body h4 .fa-link,.markdown-body h5 .fa-link,.markdown-body h6 .fa-link{color:#000;vertical-align:middle;visibility:hidden;font-size:16px}.night .markdown-body h1 .fa-link,.night .markdown-body h2 .fa-link,.night .markdown-body h3 .fa-link,.night .markdown-body h4 .fa-link,.night .markdown-body h5 .fa-link,.night .markdown-body h6 .fa-link{color:#fff}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .fa-link,.markdown-body h2:hover .anchor .fa-link,.markdown-body h3:hover .anchor .fa-link,.markdown-body h4:hover .anchor .fa-link,.markdown-body h5:hover .anchor .fa-link,.markdown-body h6:hover .anchor .fa-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.night .markdown-body table tr{background-color:#5f5f5f}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.night .markdown-body table tr:nth-child(2n){background-color:#4f4f4f}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.night .markdown-body code,.night .markdown-body tt{color:#eee;background-color:hsla(0,0%,90.2%,.36)}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.night .markdown-body pre{filter:invert(100%)}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-webkit-inline-flex;display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.night .markdown-body .gist table tr:nth-child(2n){background-color:#ddd}.markdown-body code[data-gist-id]{background:none;padding:0;filter:invert(100%)}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.night .markdown-body pre.graphviz .graph>polygon{fill:#333}.night .markdown-body pre.mermaid .sectionTitle,.night .markdown-body pre.mermaid .titleText,.night .markdown-body pre.mermaid text{fill:#fff}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.night .markdown-body .abc path{fill:#eee}.night .markdown-body .abc path.note_selected{fill:##4DD0E1}.night tspan{fill:#fefefe}.night pre rect{fill:transparent}.night pre.flow-chart path,.night pre.flow-chart rect{stroke:#fff}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body img{background-color:transparent}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;-webkit-transition:opacity .2s;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;-webkit-transition:opacity .2s;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.3;background-color:#ccc;border:none}.ui-toc-label,.ui-toc .open .ui-toc-label{-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.night .ui-toc-dropdown .nav>li>a:focus,.night .ui-toc-dropdown .nav>li>a:hover{color:#fff;border-left-color:#fff}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.night .ui-toc-dropdown .nav>.active:focus>a,.night .ui-toc-dropdown .nav>.active:hover>a,.night .ui-toc-dropdown .nav>.active>a{color:#fff;border-left:2px solid #fff}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.night .ui-toc-dropdown .nav>li>a{color:#aaa}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,"\30D2\30E9\30AE\30CE\89D2\30B4   Pro W3",Osaka,Meiryo,"\30E1\30A4\30EA\30AA",MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,"\5FAE\8EDF\6B63\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,"\5FAE\8EDF\6B63\9ED1UI",sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,"\5FAE\8F6F\96C5\9ED1UI",sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown{display:inline-block}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}.night .navbar{background:#333;border-bottom-color:#333;color:#eee}.night .navbar a{color:#eee}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid"><h1 id="AI-for-TDTR-探索"><a class="anchor hidden-xs" href="#AI-for-TDTR-探索" title="AI-for-TDTR-探索"><i class="fa fa-link"></i></a>AI for TDTR 探索</h1><blockquote>
<p>AI for Time-Domain Thermoreflectance (TDTR)</p>
</blockquote><p>最近随着 LLM 的兴起，原本用在计算机领域的深度学习模型，开始在各个领域掀起一股 <strong>AI for Science</strong> 的热潮，也就是将机器学习的方法应用到传统的自然科学，比如传热、流动、天气预测。</p><p>然而，AI 真的是万能钥匙吗？真的所有领域都适合 AI 吗？</p><p>在拿到计算机博士学位之前，我学的是热物理。</p><p>曾经的本科同学，很多也拿到了热物理的博士学位。于是某位不愿透露姓名的张 * 同学，希望试试能不能把 AI 应用到 热物理。这位不愿透露姓名的 * 创 同学又找到了远在东京做实验的 * 汝磊 同学，打算一起试试能不能用 AI 来优化 传热实验 <strong>TDTR ( Time-Domain Thermoreflectance)</strong>。</p><br><h1 id="TDTR-介绍"><a class="anchor hidden-xs" href="#TDTR-介绍" title="TDTR-介绍"><i class="fa fa-link"></i></a>TDTR 介绍</h1><p>这里简单介绍一下 TDTR 实验，它的目的是测量材料的热性质，例如热导率 (Thermal Conductivity)、热容 (Volumetric Heat Capacity)，试验台架看起来是这样的：</p><p><a href="https://pmiclab.com/testing-services/thermal-conductivity/time-domain-thermoreflectance-tdtr/" target="_blank" rel="noopener"><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/tdtr_exp.png" alt="img"></a></p><p>可能有人会注意到，不是说测量热性质吗？这明显看起来是一个光学台架呀。</p><p>没错，<strong>TDTR 就是利用激光来测量材料的热性质</strong>，它可以测量非常薄的材料。一个材料非常薄的时候 (几纳米 nm 到 几微米 um)，相比几厘米厚的同一种材料 (Bulk Material)，它的热性质会发生非常大的变化，所以我们需要一种实验，能测量非常薄的薄膜材料。</p><p>TDTR ( Time-Domain Thermoreflectance) 从名字来看，有 Time-Domain 和 Thermoreflectance 两部分，接下来我会分别介绍。</p><h2 id="Thermoreflectance"><a class="anchor hidden-xs" href="#Thermoreflectance" title="Thermoreflectance"><i class="fa fa-link"></i></a>Thermoreflectance</h2><p>想要测量非常薄的材料，头疼的地方在于，<strong>微弱的热信号很多时候并不方便直接测量</strong>，所以 TDTR 将热信号转变成了方便测量的光信号：反射率 (Reflectance)，我们可以用 R 表示。<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 8.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.899em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.811em, 1006.9em, 3.235em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mfrac" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1001.57em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.805em;"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">R</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.374em;"><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.73em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.727em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-9" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtext" id="MathJax-Span-15" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">Δ</mi><mi>R</mi></mrow><mi>R</mi></mfrac><mo>=</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mi>R</mi></mrow></msub><mtext>&nbsp;</mtext><mi mathvariant="normal">Δ</mi><mi>T</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">
\frac{\Delta R}{R}=C_{TR}\ \Delta T
</script></span><br>
当温度变化非常小的时候 (&lt;10K)，一个材料表面的反射率 R 的变化和温度变化 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-18" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.51em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\Delta T</script></span> 是线性相关的，所以我们可以通过测量 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" style="width: 1.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.62em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">\Delta R</script></span> 来间接测量温度变化 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.51em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">\Delta T</script></span>，这种特性也称为 Thermoreflectance。</p><p><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/tdtr_exp_1.png" alt="image-20250901183616186"></p><p>于是我们就有了一个构想：用一束激光 (Pump Beam) 去加热材料表面，然后用另一束激光 (Probe Beam) 去探测材料表面的反射率，这样就可以通过光信号测量到温度变化了，而且激光的好处是非接触，也不会破坏材料。</p><h2 id="Time-Domain"><a class="anchor hidden-xs" href="#Time-Domain" title="Time-Domain"><i class="fa fa-link"></i></a>Time Domain</h2><p>前面提到，我们要用一束激光去加热材料表面，再用另一束激光探测材料表面的响应。</p><blockquote>
<p>这里顺便一提，实际上实验只需要一个激光源，通过 PBS (Polarizing Beam Splitter) 分成两束激光，再用 EOM (Electro Optic Modulator) 调制成需要的频率。</p>
</blockquote><p>这两束激光之间，需要有一段时间间隔，称为弛豫时间 (relaxation time <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.87em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>τ</mi><mi>d</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">\tau_d</script></span>)。因为热传递是需要时间的，所以下面这张图 Pump 和 Probe 激光直接有一段时间间隔。</p><blockquote>
<p>两束激光的延迟，可以通过机械结构，改变两条光路的距离，这样两束激光到达材料的时间就有一个延迟了。</p>
</blockquote><p><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/pump_probe.png" alt="image-20250901185557692"></p><p>另一方面，<strong>只有在温度变化非常小的时候 (&lt;10K)</strong>，一个材料表面的反射率 R 变化和温度变化 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-35" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.51em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">\Delta T</script></span> 才是线性相关的，所以通常使用正弦的高频激光，作为 Pump 脉冲去加热材料表面，再用一个方波调至的 Probe 激光探测材料对脉冲的响应。</p><p><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/probe_signal.png" alt="image-20250901190046697"></p><p>这样一个高频正弦信号，和一个方波信号叠加，就是最后传感器能检测到的光信号。</p><p><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/signal_response.png" alt="image-20250901190600402"></p><p>但是，只有一组数据是无法拟合的，所以我们需要改变弛豫时间 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-39" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.87em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-40"><span class="msubsup" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>τ</mi><mi>d</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">\tau_d</script></span>，得到一组响应曲线。</p><p>由于热性质不同，这样不同材料的响应曲线也是不同的，<strong>所以我们根据响应曲线就能反推出材料的热性质</strong>。</p><p><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/tdtr_curve.png" alt="image-20250901190853752"></p><p>当然，虽然说是 Time Domain，实际上信号处理后面需要傅里叶变化 (Fourier Transform) ，因为激光脉冲是按一定频率持续不断发射的，<strong>所以最后的响应也是一连串脉冲信号的叠加，也就是卷积</strong>。而傅里叶变换之后，在频域进行卷积，可以简化成两个信号的加法，后面也可以看到 GPU 计算都是用的复数 (Complex Number)。</p><p><strong>后面代码可以看到，TDTR 的运算都是包含复数 <code>a+bj</code> 的。</strong></p><br><h1 id="AI-for-TDTR"><a class="anchor hidden-xs" href="#AI-for-TDTR" title="AI-for-TDTR"><i class="fa fa-link"></i></a>AI for TDTR</h1><p>那么问题来了，这看起来就是一个傅里叶导热问题，为什么需要 AI 呢？</p><p><strong>确实 TDTR 是有完整的理论模型的</strong>，只要知道实验的激光频率，材料的热特性，我们就可以用理论模型计算得到响应曲线。</p><p>比如激光我们可以建模为一个圆形的激光束，在不同时间 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-44" style="width: 0.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.38em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.33em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">t</script></span>，不同半径 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">r</script></span> 的激光强度有完整的理论公式：<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;exp&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 25.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.824em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.649em, 1021.72em, 3.72em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="msubsup" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mn" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">t</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-61" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1001.67em, 4.313em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.859em;"><span class="mrow" id="MathJax-Span-62"><span class="mn" id="MathJax-Span-63" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="mn" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1001.62em, 4.151em, -999.997em); top: -3.23em; left: 50%; margin-left: -0.805em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-69"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.649em;"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.78em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.781em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mtext" id="MathJax-Span-72" style="font-family: MathJax_Main;">exp</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.02em, 1001.4em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.698em;"><span class="mrow" id="MathJax-Span-76"><span class="mn" id="MathJax-Span-77" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.434em;"><span class="mn" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.02em, 1001.03em, 4.475em, -999.997em); top: -3.176em; left: 50%; margin-left: -0.536em;"><span class="msubsup" id="MathJax-Span-81"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -4.308em; left: 0.649em;"><span class="mn" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 0.649em;"><span class="mn" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.51em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.511em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-86"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.488em;"><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="msubsup" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.434em;"><span class="mn" id="MathJax-Span-93" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-95" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.38em;"><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1002.21em, 4.313em, -999.997em); top: -2.961em; left: 0em;"><span class="texatom" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.757em;"><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-115" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.38em;"><span class="mn" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.434em; border-left: 0px solid; width: 0px; height: 3.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>2</mn><msub><mi>A</mi><mn>1</mn></msub></mrow><mrow><mi>π</mi><msup><mi>ω</mi><mn>2</mn></msup></mrow></mfrac><mtext>exp</mtext><mo stretchy="false">(</mo><mo>−</mo><mfrac><mrow><mn>2</mn><msup><mi>r</mi><mn>2</mn></msup></mrow><msubsup><mi>ω</mi><mn>1</mn><mn>2</mn></msubsup></mfrac><mo stretchy="false">)</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><msub><mi>ω</mi><mn>0</mn></msub><mi>t</mi></mrow></msup><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">∞</mi></mrow></munderover><mi>δ</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mi>n</mi><msub><mi>T</mi><mi>s</mi></msub><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">
p_1(r, t)=\frac{2A_1}{\pi\omega^2}\text{exp}(-\frac{2r^2}{\omega_1^2})e^{i\omega_0t}\sum_{n=-\infty}^{\infty}\delta(t-nT_s-t_0)
</script></span><br>
而接下来的热传导，也遵循傅里叶导热定律：<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-119" style="width: 16.975em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.604em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.703em, 1014.6em, 3.289em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mfrac" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1001.3em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.644em;"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.92em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.482em;"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.4em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.404em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-130" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1001.78em, 4.367em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.859em;"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-133"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.865em;"><span class="mi" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.213em;"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.89em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.888em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.97em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.482em;"><span class="mrow" id="MathJax-Span-139"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.13em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.134em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math-italic;">r</span><span class="mfrac" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1001.3em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.644em;"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.97em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.482em;"><span class="mrow" id="MathJax-Span-148"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.4em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.404em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="msubsup" id="MathJax-Span-153" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.865em;"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.02em, 1001.78em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.859em;"><span class="mrow" id="MathJax-Span-157"><span class="msubsup" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mn" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1001.51em, 4.151em, -999.997em); top: -3.23em; left: 50%; margin-left: -0.752em;"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.541em;"><span class="mn" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.89em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.888em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>η</mi><msub><mi>K</mi><mi>z</mi></msub></mrow><mi>r</mi></mfrac><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mo stretchy="false">(</mo><mi>r</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><msub><mi>K</mi><mi>z</mi></msub><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi>z</mi><mn>2</mn></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">
C\frac{\partial T}{\partial t} = \frac{\eta K_z}{r}\frac{\partial}{\partial r}(r\frac{\partial T}{\partial r}) + K_z\frac{\partial^2T}{\partial z^2}
</script></span><br>
所以我们可以用理论模型，<strong>从 激光参数 和 材料的热参数，推导出最后的响应曲线</strong>。</p><blockquote>
<p>TDTR 完整的理论推导推荐下面的 YouTube 视频，介绍得非常详细。</p>
<p><a href="https://www.youtube.com/playlist?list=PLu90K6-O5kAxjF35cE1jkNp1-WyQDK1Cm" target="_blank" rel="noopener">https://www.youtube.com/playlist?list=PLu90K6-O5kAxjF35cE1jkNp1-WyQDK1Cm</a></p>
</blockquote><p>然而问题在于，<strong>材料的热参数是未知的</strong>，这就是 TDTR 实验想要测量的。</p><ul>
<li>理论模型：激光参数 + 材料热参数 ==&gt; 响应曲线  (正问题)</li>
<li>实际实验：激光参数 + 响应曲线 ==&gt; 材料热参数 (反问题)</li>
</ul><p>所以我们可以看到，<strong>正问题有理论依据非常成熟，但是反问题就没法求解了</strong>。现在很多 AI for Science 都是希望用深度学习去求解反问题。</p><p>针对 TDTR，传统方法是用 启发式寻优算法 (Heuristic Search) 去寻找可能的热参数。比如用 模拟退火，蚁群，遗传算法，在众多可能的热参数中寻找，不停地尝试。如果找到一组参数，能和实验的响应曲线拟合上，那就确定材料的热参数了。</p><p>那么，现在 LLM 带动 AI 的热潮，能不能用 AI 的方法来解决 TDTR 传热问题呢？</p><blockquote>
<p>这半年多，我空闲的时候陆续思考了一些 AI 解决 TDTR 反问题的新思路，在这里总结一下。</p>
</blockquote><p><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/ai_for_tdtr.png" alt="image-20250901202127740"></p><br><h2 id="方法-1-Surrogate-Model"><a class="anchor hidden-xs" href="#方法-1-Surrogate-Model" title="方法-1-Surrogate-Model"><i class="fa fa-link"></i></a>方法 1: Surrogate Model</h2><p>首先，最为常见的操作就是用深度学习的模型，去替代传统的物理传热模型。<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 4.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.72em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.61em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">
y=f(x)
</script></span><br>
比如上面的函数 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13">f(x)</script></span> 既可以是理论物理模型，也可以是一个深度学习模型来近似理论模型。</p><p>这里就有一个问题了，深度学习模型的拟合能力是非常强的，我们怎么能保证深度学习替代的模型，和物理模型完全一致呢？</p><p>于是就诞生了 <strong>PINN (Physics Informed Neural Network)</strong>，其实想法非常直白，就是在深度学习模型训练的时候，在 Loss Function 里面加上一些物理约束：<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;loss&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mtext&gt;loss&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mtext&gt;loss&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;y&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-296" style="width: 13.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.371em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1011.37em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-297"><span class="mtext" id="MathJax-Span-298" style="font-family: MathJax_Main;">loss</span><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-300" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.912em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.51em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mtext" id="MathJax-Span-301" style="font-family: MathJax_Main;">loss</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 1.565em;"><span class="texatom" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="mi" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="msubsup" id="MathJax-Span-308" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 4.367em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.51em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mtext" id="MathJax-Span-309" style="font-family: MathJax_Main;">loss</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 1.565em;"><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">p</span><span class="mi" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">h</span><span class="mi" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">y</span><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">s</span><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">i</span><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">c</span><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>loss</mtext><mo>=</mo><msub><mtext>loss</mtext><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><msub><mtext>loss</mtext><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">p</mi><mi mathvariant="bold-italic">h</mi><mi mathvariant="bold-italic">y</mi><mi mathvariant="bold-italic">s</mi><mi mathvariant="bold-italic">i</mi><mi mathvariant="bold-italic">c</mi><mi mathvariant="bold-italic">s</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">
\text{loss} = \text{loss}_{mse} + \boldsymbol{\text{loss}_{physics}}
</script></span><br>
而常见的物理约束，可以是偏微分方程，因为深度学习求导数是非常容易的。</p><p>比如 Navier-Stokes 流体方程：<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-319" style="width: 4.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.99em, 2.589em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-320"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Main;">∇</span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main; padding-left: 0.218em;">⋅</span><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-bold-italic; padding-left: 0.218em;">u</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-325" style="font-family: MathJax_Main; padding-left: 0.272em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold-italic">u</mi><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-25">
\nabla \cdot \boldsymbol{u}=0
</script></span><br>
这个等式右边的零约束，就可以加入到 Loss Function 里面。</p><h3 id="11-PINN-正问题"><a class="anchor hidden-xs" href="#11-PINN-正问题" title="11-PINN-正问题"><i class="fa fa-link"></i></a>1.1 PINN 正问题</h3><p>前面提到，TDTR 的正问题非常简单，有成熟的理论模型，但是反问题比较困难。</p><p>比如 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-217" style="width: 3.343em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.858em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1002.86em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-221" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="mn" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-16">y=x^2</script></span> 这个函数，一个 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-224" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-225"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">x</script></span> 对应一个 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-227" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">y</script></span>，和深度学习模型一样都是一输入，一输出。</p><p><img src="https://mathcentral.uregina.ca/qq/database/qq.09.06/mike1.1.gif" alt="y = x^2 - 2"></p><p>有的时候正问题，可能都不需要加物理约束就能拟合得很好了。但有的时候模型训练又很容易过拟合，这取决于具体的物理模型，现在还没有一个通用的方法。</p><blockquote>
<p>针对 TDTR，就是我们训练一个深度学习模型，输入是激光和材料的热参数，输出则是 TDTR 的响应曲线。</p>
</blockquote><p>用 AI 拟合正问题的好处是：</p><ul>
<li>深度学习模型，比传统物理模型求解快，因为传统数值方法离散后迭代，通常不好用 GPU 加速。</li>
<li>保护理论模型知识产权，比如不想让别人知道物理模型的细节，可以训练一个深度学习代理模型，输入输出都是一样的，这样就不用直接提供原始物理模型了。</li>
</ul><h3 id="12-PINN-反问题"><a class="anchor hidden-xs" href="#12-PINN-反问题" title="12-PINN-反问题"><i class="fa fa-link"></i></a>1.2 PINN 反问题</h3><p>用深度学习拟合反问题就比较麻烦了，因为反问题很多时候会有多对一的问题。</p><p>比如 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-230" style="width: 3.343em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.858em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1002.86em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-234" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="mn" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">y=x^2</script></span> 的反问题，<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x00B1;&lt;/mo&gt;&lt;msqrt&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-237" style="width: 4.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1004.04em, 2.912em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main; padding-left: 0.272em;">±</span><span class="msqrt" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.811em;"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.973em, 1000.49em, 1.296em, -999.997em); top: -1.775em; left: 0.811em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.051em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span><span style="position: absolute; clip: rect(3.02em, 1000.87em, 4.367em, -999.997em); top: -3.823em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo>±</mo><msqrt><mi>y</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-20">x=\pm\sqrt{y}</script></span> 有2个解，这个时候我们就需要加物理约束，告诉深度学习模型我们想拟合的是 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-245" style="width: 3.774em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.235em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1003.24em, 2.912em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-248" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msqrt" id="MathJax-Span-249" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.811em;"><span class="mrow" id="MathJax-Span-250"><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.973em, 1000.49em, 1.296em, -999.997em); top: -1.775em; left: 0.811em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.051em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span><span style="position: absolute; clip: rect(3.02em, 1000.87em, 4.367em, -999.997em); top: -3.823em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msqrt><mi>y</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-21">x=\sqrt y</script></span> 还是 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msqrt&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-252" style="width: 4.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1004.04em, 2.912em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main; padding-left: 0.272em;">−</span><span class="msqrt" id="MathJax-Span-257"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.811em;"><span class="mrow" id="MathJax-Span-258"><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.973em, 1000.49em, 1.296em, -999.997em); top: -1.775em; left: 0.811em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.051em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span><span style="position: absolute; clip: rect(3.02em, 1000.87em, 4.367em, -999.997em); top: -3.823em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo>−</mo><msqrt><mi>y</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-22">x = -\sqrt y</script></span>。</p><p><img src="https://doc.wuhanstudio.cc/posts/tdtr_slang/multi.png" alt="image-20250901203157058"></p><blockquote>
<p>针对 TDTR，就是用深度学习去训练一个模型，输入是 TDTR 的响应曲线 和 激光参数，输出则是想要测量的材料热参数。</p>
</blockquote><p>用 AI 拟合反问题的好处是一步到位，原本理论模型无法解决的反问题，现在可以直接求解了。</p><br><h2 id="方法-2-Differentiable-TDTR"><a class="anchor hidden-xs" href="#方法-2-Differentiable-TDTR" title="方法-2-Differentiable-TDTR"><i class="fa fa-link"></i></a>方法 2: Differentiable TDTR</h2><p>另一个思路是，传统方法的缺点在于：</p><ul>
<li>物理模型不可微分，所以只能用启发式优化，例如遗传算法、模拟退火来搜寻；</li>
<li>物理模型计算太慢，导致寻优需要花费非常多的时间。</li>
</ul><p>**那么我们能不能直接正面解决这2个问题呢？**而不是绕弯到去用 AI for Science 再训练一个模型。</p><p>下面的解决方法可能是 TDTR 特有的，因为我发现 TDTR 计算最花费时间的其实是下面的矩阵乘法，而这个计算过程本身就是可微，也可以用 GPU 去加速的，所以并不是一定要用 AI 深度学习模型。</p><pre><code>q = np.zeros((ksize, omegasize, Nlayer), dtype=complex)
b = np.zeros((ksize, omegasize, Nlayer), dtype=complex)
c = np.zeros((ksize, omegasize, Nlayer), dtype=complex)

for index in range(Nlayer):
    # 这个其实就是把列向量复制扩展成矩阵
    q[:, :, index] = np.sqrt(np.dot(np.ones((ksize, 1)), 1j * omega / alpha[0, index]) + np.dot(k2, np.ones((1, omegasize))))
    # 下面两行，都是矩阵的 element-wise 乘法，可以用 GPU 加速
    b[:, :, index] = np.multiply(np.divide(-1, kappa[0, index] * q[:, :, index]), np.tanh(q[:, :, index] * d[0, index]))
    c[:, :, index] = np.multiply(-kappa[0, index] * q[:, :, index], np.tanh(q[:, :, index] * d[0, index]))
</code></pre><blockquote>
<p>当然，也可能是我只是想借助 TDTR 去学一下 JAX 和 Slang Shader。</p>
</blockquote><h3 id="21-TDTR-自动微分-JAX"><a class="anchor hidden-xs" href="#21-TDTR-自动微分-JAX" title="21-TDTR-自动微分-JAX"><i class="fa fa-link"></i></a>2.1 TDTR 自动微分 (JAX)</h3><p>深度学习模型的一个好处就是可微，现在除了深度学习模型，很多 numpy 线性代数的运算，也可以用自动微分 (Automatic Differentiation) 来保存梯度了，其中非常有名的就是 JAX。</p><p>很多 LLM 为了在 GPU 上高性能训练，也是用 JAX 而不是 Pytorch 实现的。而 JAX 除了自动微分，也可以自动 GPU加速，<strong>但是这个的前提是需要提前知道所有的输入输出，和中间变量的计算图</strong>，比如我们不能动态地创造一个矩阵，并且也不能直接替换迭代矩阵里的数值。</p><p>比如：</p><pre><code># 这是不行的
q[0] = 3
</code></pre><p>需要更改成：</p><pre><code>q.at[0].set(3)
</code></pre><p>除了这些问题外，几乎可以直接用 JAX 来替换 Numpy，入门门槛非常低。</p><p>于是用 JAX 重新实现 TDTR 的正模型，其实就是提前初始化好各种变量，然后把矩阵更新 (In-place Update) 全部替换成 <code>array.at[].set()</code> 函数就可以了，接下来 JAX 会帮助我们保存梯度信息和 GPU 加速。</p><pre><code>for index in range(Nlayer):
    q = q.at[:, :, index].set( jnp.sqrt(jnp.dot(jnp.ones((ksize, 1)), 1j * omega / alpha[0, index]) + jnp.dot(k2, jnp.ones((1, omegasize)))) )
    b = b.at[:, :, index].set( jnp.multiply(jnp.divide(-1, kappa[0, index] * q[:, :, index]), jnp.tanh(q[:, :, index] * d[0, index])) )
    c = c.at[:, :, index].set( jnp.multiply(-kappa[0, index] * q[:, :, index], jnp.tanh(q[:, :, index] * d[0, index])) )
</code></pre><p>而有了梯度之后，我们也不需要老老实实完全用遗传算法、模拟退火来寻优了，可以结合 JAX 的梯度信息，加速寻优的过程。</p><h3 id="22-TDTR-硬件加速-Slang-Shader"><a class="anchor hidden-xs" href="#22-TDTR-硬件加速-Slang-Shader" title="22-TDTR-硬件加速-Slang-Shader"><i class="fa fa-link"></i></a>2.2 TDTR 硬件加速 (Slang Shader)</h3><p>除了 JAX 提供 <strong>自动微分</strong> 和 <strong>GPU 硬件加速</strong>外，NVIDIA 最近也推出了全新的 <strong>Slang Shader</strong> 来在 GPU 上实现自动微分。</p><blockquote>
<p>Slang 是在微软 DirectX 的 HLSL (High-level Shader Language) 上扩展而来的，如果熟悉 Unity3D 游戏开发，用过 HLSL 可能会发现 Slang 非常容易上手。</p>
</blockquote><p>但是 Slang Shader 的门槛可能相比 JAX 要高一些，在学习 Slang 之前，强烈建议至少熟悉 OpenGL 或者 Vulkan 的 Compute Shader：</p><ul>
<li><a href="https://doc.wuhanstudio.cc/posts/vulkan_cs.html" target="_blank" rel="noopener">Vulkan Compute Shader (GPU 硬件加速)</a></li>
</ul><p>那么问题来啦，你可能会问既然是 Compute Shader，为什么不直接用 GLSL 而非要去用 Slang 呢？</p><p>除了 Slang 提供自动微分外，它还提供类似 C++ 的扩展，比如运算符重载，还可以给 struct 添加函数，这对于 TDTR 的复数操作非常友好，没有运算符重载，如果用 GLSL 实现复数运算可能要写一堆函数了。</p><p>另一个好处是，Slang 可以直接用 Python，不像 OpenGL 和 Vulkan 主要面对 C/C++ 用户，所以可以直接用 Python 初始化 GPU 并且加载一个 Compute Shader：</p><pre><code>import slangpy as spy

# 初始化 GPU
device = spy.Device(
    type=spy.DeviceType.vulkan,
    enable_print=True
)

print(device)

# 加载 Compute Shader
program = device.load_program("tdtr.slang", ["main"])
kernel = device.create_compute_kernel(program)
</code></pre><p>当然，既然是 GPU 编程，还是需要手动初始化 buffer，把数据从 CPU 内存复制到 GPU 内存，最后把 GPU 的运算结果转换回 CPU 的 Numpy 矩阵：</p><pre><code># Input buffers
buffer_k2 = device.create_buffer(
    element_count=ksize,
    struct_type=kernel.reflection.main.k2,
    usage=spy.BufferUsage.shader_resource,
    data=k2[:, 0].astype(np.float32),
)

...

# Output buffer
buffer_b_re = device.create_buffer(
    element_count=(ksize*omegasize*(1+N_layers)),
    struct_type=kernel.reflection.main.b_re,
    usage=spy.BufferUsage.unordered_access,
)

buffer_b_im = device.create_buffer(
    element_count=(ksize*omegasize*(1+N_layers)),
    struct_type=kernel.reflection.main.b_im,
    usage=spy.BufferUsage.unordered_access,
)

...

# Dispatch the computing
kernel.dispatch(
    thread_count=[101, 1, 1], 
    k2=buffer_k2, 
    ...
    b_re=buffer_b_re,
    b_im=buffer_b_im,
    c_re=buffer_c_re,
    c_im=buffer_c_im
)
</code></pre><p>最后就是用 Slang Shader 实现的 TDTR，其实就是用 Slang 实现了复数的运算，并且加速了矩阵运算：</p><pre><code>import sgl.device.print;

struct Complex
{
    float re;
    float im;

    __init(float real, float imaginary ) { re = real; im = imaginary;}
}

Complex operator+(Complex a, Complex b)
{
    return Complex(a.re + b.re, a.im + b.im);
}

Complex operator-(Complex a, Complex b)
{
    return Complex(a.re - b.re, a.im - b.im);
}

Complex operator*(Complex a, Complex b)
{
    return Complex(a.re * b.re - a.im * b.im, a.re * b.im + a.im * b.re);
}

Complex operator/(Complex a, Complex b)
{
    return Complex( (a.re*b.re + a.im*b.im) / (b.re*b.re + b.im*b.im), (-a.re*b.im + a.im*b.re) / (b.re*b.re + b.im*b.im));
}

Complex operator*(float b, Complex a)
{
    return Complex(a.re * b, a.im * b);
}

Complex operator*(Complex a, float b)
{
    return Complex(a.re * b, a.im * b);
}

// Square Root for Complex Number
// https://proofwiki.org/wiki/Square_Root_of_Complex_Number_in_Cartesian_Form
Complex sqrt(Complex c)
{
    float z = sqrt( pow(c.re, 2) + pow(c.im, 2) );
    float c_re = sqrt( (z + c.re) / 2 );
    float c_im = sign(c.im) * sqrt( (z - c.re) / 2 );

    return Complex(c_re, c_im);
}

// tanh for Complex Number
// Formulation 3: https://proofwiki.org/wiki/Hyperbolic_Tangent_of_Complex_Number
Complex tanh(Complex c)
{
    float tanh_re = (tanh(c.re) + tanh(c.re)*pow(tanh(c.im), 2)) / (1 + pow(tanh(c.re), 2) * pow(tanh(c.im), 2));
    float tanh_im = (tanh(c.im) - tanh(c.im)*pow(tanh(c.re), 2)) / (1 + pow(tanh(c.re), 2) * pow(tanh(c.im), 2));

    return Complex(tanh_re, tanh_im);
}

[shader("compute")]
[numthreads(64, 1, 1)]
void main(
    uint3 tid: SV_DispatchThreadID,
    StructuredBuffer&lt;float&gt; k2,
    StructuredBuffer&lt;float&gt; alpha,
    StructuredBuffer&lt;float&gt; kappa,
    StructuredBuffer&lt;float&gt; d,
    StructuredBuffer&lt;float&gt; omega,
    RWStructuredBuffer&lt;float&gt; b_re,
    RWStructuredBuffer&lt;float&gt; b_im,
    RWStructuredBuffer&lt;float&gt; c_re,
    RWStructuredBuffer&lt;float&gt; c_im
)
{
    if (tid.x &gt; 100) return;

    uint id_l = tid.x;
    uint ksize = k2.getCount();
    uint omegasize = omega.getCount();

    for(uint id_k = 0; id_k &lt; ksize; id_k++)
        for(uint id_o = 0; id_o &lt; omegasize; id_o++)
        {
            float q_re = k2[id_k];
            float q_im = omega[id_o] / alpha[id_l];

            Complex q = Complex(q_re, q_im);
    
            Complex q_sqrt = sqrt(q);
    
            float kp = kappa[id_l]; 
            float dl = d[id_l];

            Complex c1 = tanh(q_sqrt * dl);
            Complex c2 = -1.0 * kp * q_sqrt;

            Complex b = c1 / c2;
            Complex c = c1 * c2;

            b_re[id_k * omegasize * 101 + id_o * 101 + id_l] = b.re;
            b_im[id_k * omegasize * 101 + id_o * 101 + id_l] = b.im;

            c_re[id_k * omegasize * 101 + id_o * 101 + id_l] = c.re;
            c_im[id_k * omegasize * 101 + id_o * 101 + id_l] = c.im;
        }
}
</code></pre><h1 id="总结"><a class="anchor hidden-xs" href="#总结" title="总结"><i class="fa fa-link"></i></a>总结</h1><p>AI for Science 还是一个非常新的研究方向，很多文章里其实都是用的非常简单、基础的深度学习模型。</p><p>另一方面，并不是所有的物理模型都是适合 AI 的，比如 TDTR 其实物理模型本身就是可微分的，也可以用 GPU 加速，并不是一定需要用深度学习去替代这个物理模型。</p><p>最后，下面几个方向其实都是做的类似的研究：</p><ul>
<li>AI for Science: 非常大的话题，实际更偏向商业化应用和宣传；</li>
<li>Scientific Machine Learning (SciML): 用机器学习的方法，去解决科学问题；</li>
<li>Differentiable Physics: 让传统的物理模型可微，比如让傅里叶变化可微分，更偏理论研究。</li>
</ul></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#AI-for-TDTR-探索" title="AI for TDTR 探索">AI for TDTR 探索</a></li>
<li class=""><a href="#TDTR-介绍" title="TDTR 介绍">TDTR 介绍</a><ul class="nav">
<li class=""><a href="#Thermoreflectance" title="Thermoreflectance">Thermoreflectance</a></li>
<li><a href="#Time-Domain" title="Time Domain">Time Domain</a></li>
</ul>
</li>
<li class=""><a href="#AI-for-TDTR" title="AI for TDTR">AI for TDTR</a><ul class="nav">
<li class=""><a href="#方法-1-Surrogate-Model" title="方法 1: Surrogate Model">方法 1: Surrogate Model</a><ul class="nav">
<li class=""><a href="#11-PINN-正问题" title="1.1 PINN 正问题">1.1 PINN 正问题</a></li>
<li class=""><a href="#12-PINN-反问题" title="1.2 PINN 反问题">1.2 PINN 反问题</a></li>
</ul>
</li>
<li class=""><a href="#方法-2-Differentiable-TDTR" title="方法 2: Differentiable TDTR">方法 2: Differentiable TDTR</a><ul class="nav">
<li class=""><a href="#21-TDTR-自动微分-JAX" title="2.1 TDTR 自动微分 (JAX)">2.1 TDTR 自动微分 (JAX)</a></li>
<li class=""><a href="#22-TDTR-硬件加速-Slang-Shader" title="2.2 TDTR 硬件加速 (Slang Shader)">2.2 TDTR 硬件加速 (Slang Shader)</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#总结" title="总结">总结</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li><a href="#AI-for-TDTR-探索" title="AI for TDTR 探索">AI for TDTR 探索</a></li>
<li class=""><a href="#TDTR-介绍" title="TDTR 介绍">TDTR 介绍</a><ul class="nav">
<li class=""><a href="#Thermoreflectance" title="Thermoreflectance">Thermoreflectance</a></li>
<li><a href="#Time-Domain" title="Time Domain">Time Domain</a></li>
</ul>
</li>
<li class=""><a href="#AI-for-TDTR" title="AI for TDTR">AI for TDTR</a><ul class="nav">
<li class=""><a href="#方法-1-Surrogate-Model" title="方法 1: Surrogate Model">方法 1: Surrogate Model</a><ul class="nav">
<li class=""><a href="#11-PINN-正问题" title="1.1 PINN 正问题">1.1 PINN 正问题</a></li>
<li class=""><a href="#12-PINN-反问题" title="1.2 PINN 反问题">1.2 PINN 反问题</a></li>
</ul>
</li>
<li class=""><a href="#方法-2-Differentiable-TDTR" title="方法 2: Differentiable TDTR">方法 2: Differentiable TDTR</a><ul class="nav">
<li class=""><a href="#21-TDTR-自动微分-JAX" title="2.1 TDTR 自动微分 (JAX)">2.1 TDTR 自动微分 (JAX)</a></li>
<li class=""><a href="#22-TDTR-硬件加速-Slang-Shader" title="2.2 TDTR 硬件加速 (Slang Shader)">2.2 TDTR 硬件加速 (Slang Shader)</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#总结" title="总结">总结</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/js/bootstrap.min.js" integrity="sha256-kJrlY+s09+QoWjpkOrXXwhxeaoDz9FW5SaxF8I0DibQ=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
